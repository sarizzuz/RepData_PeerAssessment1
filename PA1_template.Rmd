---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Load the data from zip file and explore the summary.
```{r}
unzip(zipfile = "activity.zip")
repdata <- read.csv("activity.csv")
dim(repdata)
str(repdata)
head(repdata)
summary(repdata)
```

## What is mean total number of steps taken per day?

Calculate the total number of steps taken per day and assign to new data.frame.
```{r}
repdailysum <- tapply(repdata$steps, repdata$date, FUN = sum, na.rm = TRUE)
```

Plotting a Histogram of the total steps taken per day
```{r}
hist(repdailysum, ylim = c(0,12), xlim = c(0,25000), breaks = 20, xlab = "Steps Taken Per Day", main = "Histogram of Total Steps Taken Per Day" )
```

Calculating the mean and median.
```{r}
meanstep <- round(mean(repdailysum, na.rm = TRUE), 2)
medstep <- median(repdailysum, na.rm = TRUE)
```
The mean and median of the total number of steps taken per day are `r meanstep` and `r medstep` respectively.

## What is the average daily activity pattern?
To plot a time series, first create a table of the average steps taken and the 
intervals.
Then make a panel plot containing a time series (i.e. type = "l")
```{r}
avgsteps <- aggregate(x=list(steps=repdata$steps), by=list(interval=repdata$interval),
                      FUN=mean, na.rm=TRUE)
with(avgsteps, {
    plot( interval, steps, type = "l",
          main = "Average Steps by Time Interval",
          xlab = "5-Minute Time Interval",
          ylab = "Average Number Of Steps Taken")
    })
```

Find the 5-min interval with maximum number of steps.
```{r}
avgsteps[which.max(avgsteps$steps),]
```

## Imputing missing values
Counting number ofrows with missing values.
```{r}
missingval <- sum(is.na(repdata$steps))
```
Number of rows with missing values is `r missingval`.

Filling in the missing values with the mean for the 5-minute interval.
First create a function that replaces the NA values
```{r}
replaceNA <- function(x, y) {
    if (is.na(x)) {
        return(y)
    }
    return(x)
}


```

## Are there differences in activity patterns between weekdays and weekends?


